right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~left_upvote+right_upvote+left_blur+right_blur+(1|subject_id)+(1|left_img)+(1|right_img), data=data.lme)
anova(lme_result)
#| label: Mixed Effect Model prep
#| echo:false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~left_upvote+right_upvote+left_blur+right_blur+(1|subject_id)+(1|left_img), data=data.lme)
anova(lme_result)
#| label: Mixed Effect Model prep
#| echo:false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~left_upvote+right_upvote+left_blur+right_blur+(1|subject_id)+(1|left_img)+(1|right_img), data=data.lme)
anova(lme_result)
#| label: Mixed Effect Model prep
#| echo:false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~left_upvote+right_upvote+left_blur+right_blur+(left_upvote-right_upvote)+(left_blur-right_upvote)+((left_upvote-right_upvote)*(left_blur-right_upvote)) +(1|subject_id)+(1|left_img)+(1|right_img), data=data.lme)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
#| label: Load R libraries
#| echo: false # hides code in rendered doc
#| message: false # hides messages in code
library(osfr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ez)
library(rjson)
library(jsonlite)
library(lme4)
library(lmerTest)
library(sjPlot)
#| label: Load the data from OSF
#| include: false # hides data objects generated by code
#| echo: false
osf_retrieve_node("x38yn") %>%
osf_ls_files(n_max = "Inf") %>%
osf_download(path="data/", conflicts="skip")
#| label: Concatenate data files into one file
#| echo: false
files <- list.files(path = "data/", full.names = T)
data <- lapply(files, fromJSON) %>%
bind_rows()
#| label: Clean up data frame
#| echo: false
data.clean <- data %>%
select(-c("success", "timeout", "failed_images", "failed_audio", "failed_video", "trial_type", "trial_index", "time_elapsed", "internal_node_id", "study_id", "session_id", "stimulus")) %>%
filter(phase == "test",
task == "choose")
#| label: Count the number of subjects
#| echo: false
n.subjects <- data %>%
pull(subject_id) %>%
unique() %>%
length()
#| label: filter failed participants
#| echo: false
data.exclude <- data.clean %>%
group_by(subject_id) %>%
mutate(n_pass = sum(check == FALSE)) %>%
filter(n_pass > 3)
exclude.subjects <- data.exclude %>%
pull(subject_id) %>%
unique() %>%
length()
data.filtered <- data.clean %>%
filter(!subject_id %in% exclude.subjects) %>%
filter(check == TRUE)
#| label: tidy up the data
#| echo: false
data.tidyup <- data.filtered %>%
pivot_longer(cols = starts_with("left_") | starts_with("right_"),
names_to = c("pos", ".value"), names_sep = "_") %>%
mutate(revealed = ifelse(((response == "arrowleft" & pos == "left") | (response == "arrowright" & pos == "right")), TRUE, FALSE)) %>%
select(subject_id, pos, upvote, blur, img, revealed)
#| label: upvote graph
#| echo: false
graph.prep <- data.tidyup %>%
group_by(upvote) %>%
summarize(percent = mean(revealed == TRUE)) %>%
ungroup()
ggplot(graph.prep, aes(x = upvote, y = percent))+
geom_point() +
stat_smooth(method = "loess", se = TRUE) +
xlab("Upvote Count") +
ylab("# of reveals / # of appearance")
#| label: blur graph
#| echo: false
graph.prep2 <- data.tidyup %>%
group_by(blur) %>%
summarize(percent = mean(revealed == TRUE)) %>%
ungroup()
ggplot(graph.prep2, aes(x = blur, y = percent))+
geom_point() +
stat_smooth(method = "loess", se = TRUE) +
xlab("Blurriness") +
ylab("# of reveals / # of appearance")
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
summary(lme_result)
anova(lme_result)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
summary(lme_result)
anova(lme_result)
plot(lme_result)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
anova(lme_result)
plot(lme_result)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
anova(lme_result)
plot(lme_result)
ranef(lme_result)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
anova(lme_result)
binnedplot(fitted(lme_result),resid(lme_result))
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = glmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
anova(lme_result)
plot(lme_result)
ranef(lme_result)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
anova(lme_result)
plot(lme_result)
ranef(lme_result)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme)
print(lme_result)
anova(lme_result)
plot(lme_result)
ranef(lme_result)
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result = lmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme,
family="binomial")
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result <- glmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme,
family="binomial")
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result <- glmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme,
family="binomial")
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result <- glmer(response~
left_upvote+
right_upvote+
(1|subject_id),
data=data.lme,
family="binomial")
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result <- glmer(response~
left_upvote+
right_upvote+
(1|subject_id),
data=data.lme,
family="binomial")
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = response,
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result <- glmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme,
family="binomial")
#| label: Mixed Effect Model prep
#| echo: false
data.lme <- data.filtered %>%
select(response, subject_id, left_upvote, right_upvote, left_blur, right_blur, left_img, right_img) %>%
mutate(delta_upvote = left_upvote-right_upvote,
delta_upvote = factor(delta_upvote),
delta_blur = left_blur-right_blur,
delta_blur = factor(delta_blur),
response = dummy(response),
subject_id = factor(subject_id),
left_upvote = factor(left_upvote),
right_upvote = factor(right_upvote),
left_blur = factor(left_blur),
right_blur = factor(right_blur),
left_img = factor(left_img),
right_img = factor(right_img))
lme_result <- glmer(response~
left_upvote+
right_upvote+
left_blur+
right_blur+
(1|subject_id),
data=data.lme,
family="binomial")
